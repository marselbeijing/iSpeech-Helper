// analytics-debug.js –æ—á–∏—â–µ–Ω –¥–ª—è –Ω–æ–≤–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Telegram Analytics SDK

// –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ Telegram Analytics
console.log('üîß Analytics Debug: –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω');

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
window.checkAnalytics = function() {
  console.log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ Telegram Analytics...');
  
  const results = {
    timestamp: new Date().toISOString(),
    environment: {
      isTelegramWebApp: !!window.Telegram?.WebApp,
      webAppVersion: window.Telegram?.WebApp?.version,
      platform: window.Telegram?.WebApp?.platform,
      userId: window.Telegram?.WebApp?.initDataUnsafe?.user?.id,
    },
    analytics: {
      packageInstalled: false,
      sdkInitialized: false,
      trackMethodAvailable: false,
      tokenPresent: false,
    },
    errors: []
  };

  try {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞–∫–µ—Ç @telegram-apps/analytics
    if (typeof window.telegramAnalytics !== 'undefined') {
      results.analytics.packageInstalled = true;
      results.analytics.trackMethodAvailable = typeof window.telegramAnalytics.track === 'function';
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
    // –í production —ç—Ç–æ –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å
    
    console.log('üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:', results);
    return results;
    
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ:', error);
    results.errors.push(error.message);
    return results;
  }
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è
window.sendTestEvent = function() {
  console.log('üß™ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ...');
  
  try {
    // –ü—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ WebApp API
    if (window.Telegram?.WebApp?.sendData) {
      const testData = {
        event: 'debug_test',
        timestamp: Date.now(),
        test_parameter: 'debug_value'
      };
      
      window.Telegram.WebApp.sendData(JSON.stringify(testData));
      console.log('‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ WebApp.sendData');
      return { success: true, method: 'WebApp.sendData', data: testData };
    } else {
      console.warn('‚ö†Ô∏è WebApp.sendData –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
      return { success: false, error: 'WebApp.sendData –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω' };
    }
    
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è:', error);
    return { success: false, error: error.message };
  }
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
window.checkToken = function() {
  console.log('üîë –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏...');
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ localStorage (–µ—Å–ª–∏ —Ç–æ–∫–µ–Ω —Ç–∞–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω)
  const localStorageKeys = Object.keys(localStorage);
  const analyticsKeys = localStorageKeys.filter(key => 
    key.toLowerCase().includes('analytics') || 
    key.toLowerCase().includes('telegram')
  );
  
  console.log('üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏ –≤ localStorage:', analyticsKeys);
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
  const hasAnalyticsGlobals = typeof window.telegramAnalytics !== 'undefined';
  
  return {
    localStorageKeys: analyticsKeys,
    hasAnalyticsGlobals: hasAnalyticsGlobals,
    webAppAvailable: !!window.Telegram?.WebApp
  };
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
window.fullAnalyticsCheck = function() {
  console.log('üî¨ –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É Analytics...');
  
  const environment = window.checkAnalytics();
  const tokenInfo = window.checkToken();
  const testResult = window.sendTestEvent();
  
  const fullReport = {
    environment,
    tokenInfo,
    testResult,
    recommendations: []
  };
  
  // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
  if (!environment.environment.isTelegramWebApp) {
    fullReport.recommendations.push('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç–æ –≤ Telegram WebApp');
  }
  
  if (!environment.analytics.packageInstalled) {
    fullReport.recommendations.push('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É –ø–∞–∫–µ—Ç–∞ @telegram-apps/analytics');
  }
  
  if (!testResult.success) {
    fullReport.recommendations.push('–ü—Ä–æ–±–ª–µ–º—ã —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ–±—ã—Ç–∏–π - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WebApp');
  }
  
  console.log('üìã –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:', fullReport);
  return fullReport;
};

console.log('‚úÖ Analytics Debug –≥–æ—Ç–æ–≤! –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:');
console.log('  - window.checkAnalytics() - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è');
console.log('  - window.sendTestEvent() - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è');
console.log('  - window.checkToken() - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞');
console.log('  - window.fullAnalyticsCheck() - –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞');

// === –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ª–∞–¥–∫–∏ Telegram Analytics ===

const ANALYTICS_TOKEN = 'eyJhcHBfbmFtZSI6ImlzcGVlY2hoZWxwZXIiLCJhcHBfdXJsIjoiaHR0cHM6Ly90Lm1lL2lTcGVlY2hIZWxwZXJfYm90L2lzcGVlY2giLCJhcHBfZG9tYWluIjoiaHR0cHM6Ly9pLXNwZWVjaC1oZWxwZXItdWNlNC52ZXJjZWwuYXBwLyJ9!B5PY86VQG7rW63+lZ9B1t642VCbXoDEdKO/UH9tQHCU=';

window.debugAnalytics = function() {
  console.log('üîç Debug Analytics: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ...');
  console.log('Token –∏–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:', ANALYTICS_TOKEN ? '–ù–ê–ô–î–ï–ù' : '–ù–ï –ù–ê–ô–î–ï–ù');
  console.log('Token length:', ANALYTICS_TOKEN.length);
  console.log('Telegram WebApp:', !!window.Telegram?.WebApp);
  console.log('telegramAnalytics:', typeof window.telegramAnalytics);
  console.log('analyticsService:', typeof window.analyticsService);
  return {
    token: ANALYTICS_TOKEN,
    tokenLength: ANALYTICS_TOKEN.length,
    webApp: !!window.Telegram?.WebApp,
    telegramAnalytics: typeof window.telegramAnalytics,
    analyticsService: typeof window.analyticsService
  };
};

window.initAnalyticsWithToken = function() {
  console.log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞–Ω–∞–ª–∏—Ç–∏–∫—É —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º...');
  try {
    if (window.telegramAnalytics && typeof window.telegramAnalytics.init === 'function') {
      window.telegramAnalytics.init({
        token: ANALYTICS_TOKEN,
        appName: 'ispeechhelper',
      });
      console.log('‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º');
      return { success: true, message: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞' };
    } else {
      console.log('‚ùå telegramAnalytics –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
      return { success: false, message: 'telegramAnalytics –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω' };
    }
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
    return { success: false, error: error.message };
  }
};

window.testAnalyticsEvent = function() {
  console.log('üß™ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ...');
  if (window.analyticsService && typeof window.analyticsService.trackFeatureUsage === 'function') {
    window.analyticsService.trackFeatureUsage('debug_test', 'manual_test');
    return '–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ';
  } else {
    return 'analyticsService –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ trackFeatureUsage –Ω–µ —Ñ—É–Ω–∫—Ü–∏—è';
  }
};

window.testTelegramAnalytics = function() {
  if (window.analyticsService && typeof window.analyticsService.testAnalytics === 'function') {
    return window.analyticsService.testAnalytics();
  } else {
    return 'analyticsService –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ testAnalytics –Ω–µ —Ñ—É–Ω–∫—Ü–∏—è';
  }
};

console.log('‚úÖ analytics-debug.js: –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ª–∞–¥–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã: window.debugAnalytics(), window.initAnalyticsWithToken(), window.testAnalyticsEvent(), window.testTelegramAnalytics()');

// –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ Telegram Analytics SDK
function checkTelegramAnalytics() {
  console.log('=== –ü–†–û–í–ï–†–ö–ê TELEGRAM ANALYTICS SDK ===');
  console.log('üìä –°—Ç–∞—Ç—É—Å: SDK —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!');
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ SDK
  if (typeof window.telegramAnalyticsSDK !== 'undefined') {
    console.log('‚úÖ Telegram Analytics SDK –∑–∞–≥—Ä—É–∂–µ–Ω (—á–µ—Ä–µ–∑ window.telegramAnalyticsSDK)');
    console.log('üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã:', Object.keys(window.telegramAnalyticsSDK));
  } else if (typeof window.telegramAnalytics !== 'undefined') {
    console.log('‚úÖ Telegram Analytics SDK –∑–∞–≥—Ä—É–∂–µ–Ω (—á–µ—Ä–µ–∑ window.telegramAnalytics)');
    console.log('üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã:', Object.keys(window.telegramAnalytics));
  } else {
    console.log('‚úÖ Telegram Analytics SDK —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö');
    console.log('üí° SDK –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ ES6 –º–æ–¥—É–ª—å –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–∫–µ—Ç–∞ @telegram-apps/analytics (–≤ React –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –º–æ–¥—É–ª—å)
  if (typeof window.telegramAnalyticsSDK !== 'undefined') {
    console.log('‚úÖ NPM –ø–∞–∫–µ—Ç @telegram-apps/analytics –¥–æ—Å—Ç—É–ø–µ–Ω (—á–µ—Ä–µ–∑ window.telegramAnalyticsSDK)');
  } else if (typeof telegramAnalytics !== 'undefined') {
    console.log('‚úÖ NPM –ø–∞–∫–µ—Ç @telegram-apps/analytics –¥–æ—Å—Ç—É–ø–µ–Ω (–≥–ª–æ–±–∞–ª—å–Ω–æ)');
  } else {
    console.log('‚ÑπÔ∏è NPM –ø–∞–∫–µ—Ç @telegram-apps/analytics –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ ES6 –º–æ–¥—É–ª—å (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)');
    console.log('üí° SDK —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö, –Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª–∏');
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram WebApp
  if (window.Telegram && window.Telegram.WebApp) {
    console.log('‚úÖ Telegram WebApp –¥–æ—Å—Ç—É–ø–µ–Ω');
    console.log('üì± –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:', window.Telegram.WebApp.platform);
    console.log('üÜî –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ID:', window.Telegram.WebApp.initDataUnsafe?.user?.id || '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ');
  } else {
    console.log('‚ùå Telegram WebApp –ù–ï –¥–æ—Å—Ç—É–ø–µ–Ω');
    console.log('üí° –í–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ Telegram');
  }
  
  console.log('=== –ö–û–ù–ï–¶ –ü–†–û–í–ï–†–ö–ò ===');
  console.log('');
  console.log('üéØ –ò–¢–û–ì: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network –≤–∫–ª–∞–¥–∫—É –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.');
}

// –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Telegram Web
function testTelegramWeb() {
  console.log('üåê === –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –í TELEGRAM WEB ===');
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ URL –∏ referrer
  console.log('üîó –¢–µ–∫—É—â–∏–π URL:', window.location.href);
  console.log('üîó Referrer:', document.referrer);
  console.log('üîó User Agent:', navigator.userAgent);
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram WebApp –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
  if (window.Telegram && window.Telegram.WebApp) {
    console.log('‚úÖ Telegram WebApp –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
    console.log('üì± –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:', window.Telegram.WebApp.platform);
    console.log('üÜî –í–µ—Ä—Å–∏—è:', window.Telegram.WebApp.version);
    console.log('üé® –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞:', window.Telegram.WebApp.colorScheme);
    console.log('üë§ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', window.Telegram.WebApp.initDataUnsafe?.user || '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ');
    console.log('üîß –†–∞—Å—à–∏—Ä–µ–Ω:', window.Telegram.WebApp.isExpanded);
    console.log('üîß –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –≤–∏–¥–Ω–∞:', window.Telegram.WebApp.MainButton?.isVisible);
  } else {
    console.log('‚ùå Telegram WebApp –ù–ï –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
    console.log('üí° –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ Telegram Web');
    
    // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ Telegram
    const hasTelegramInUrl = window.location.href.includes('telegram') || document.referrer.includes('telegram');
    console.log('üîç –ü—Ä–∏–∑–Ω–∞–∫–∏ Telegram –≤ URL:', hasTelegramInUrl);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞
    const telegramScript = document.querySelector('script[src*="telegram-web-app.js"]');
    console.log('üîç –°–∫—Ä–∏–ø—Ç Telegram WebApp –ø–æ–¥–∫–ª—é—á–µ–Ω:', !!telegramScript);
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ Network –∑–∞–ø—Ä–æ—Å–æ–≤
  console.log('üì° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É Network –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ tganalytics.xyz');
  console.log('üìä –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 200 - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç!');
  
  console.log('üåê === –ö–û–ù–ï–¶ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø ===');
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
function checkAnalyticsRealStatus() {
  console.log('üéØ === –†–ï–ê–õ–¨–ù–´–ô –°–¢–ê–¢–£–° –ê–ù–ê–õ–ò–¢–ò–ö–ò ===');
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
  const hasWebApp = !!(window.Telegram && window.Telegram.WebApp);
  const hasUser = !!(window.Telegram?.WebApp?.initDataUnsafe?.user?.id);
  const hasSDK = typeof window.telegramAnalyticsSDK !== 'undefined' || typeof telegramAnalytics !== 'undefined';
  
  console.log('‚úÖ Telegram WebApp:', hasWebApp ? '–†–∞–±–æ—Ç–∞–µ—Ç' : '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
  console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω:', hasUser ? '–î–∞' : '–ù–µ—Ç');
  console.log('‚úÖ Analytics SDK:', hasSDK ? '–ó–∞–≥—Ä—É–∂–µ–Ω' : '–†–∞–±–æ—Ç–∞–µ—Ç –≤ React');
  
  if (hasWebApp && hasUser) {
    console.log('üéâ –°–¢–ê–¢–£–°: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞!');
    console.log('üìä –°–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º');
    console.log('üì° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network ‚Üí tganalytics.xyz –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è');
  } else {
    console.log('‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –Ω–æ SDK –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å');
  }
  
  console.log('üéØ === –ö–û–ù–ï–¶ –ü–†–û–í–ï–†–ö–ò ===');
}

// –î–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≤ window –æ–±—ä–µ–∫—Ç
window.checkTelegramAnalytics = checkTelegramAnalytics;
window.testTelegramWeb = testTelegramWeb;
window.checkAnalyticsRealStatus = checkAnalyticsRealStatus;

// –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
window.analyticsStatus = function() {
  console.log('üìä === –ë–´–°–¢–†–ê–Ø –ü–†–û–í–ï–†–ö–ê –ê–ù–ê–õ–ò–¢–ò–ö–ò ===');
  const hasSDKGlobal = typeof telegramAnalytics !== 'undefined';
  const hasSDKWindow = typeof window.telegramAnalyticsSDK !== 'undefined';
  console.log('‚úÖ SDK –∑–∞–≥—Ä—É–∂–µ–Ω (–≥–ª–æ–±–∞–ª—å–Ω–æ):', hasSDKGlobal);
  console.log('‚úÖ SDK –∑–∞–≥—Ä—É–∂–µ–Ω (window):', hasSDKWindow);
  if (!hasSDKGlobal && !hasSDKWindow) {
    console.log('‚ÑπÔ∏è SDK –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ ES6 –º–æ–¥—É–ª—å - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è React');
  }
  console.log('‚úÖ Telegram WebApp:', !!(window.Telegram && window.Telegram.WebApp));
  console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ID:', window.Telegram?.WebApp?.initDataUnsafe?.user?.id || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ');
  console.log('üì° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network ‚Üí –§–∏–ª—å—Ç—Ä: tganalytics.xyz');
  console.log('üìä === –ö–û–ù–ï–¶ –ü–†–û–í–ï–†–ö–ò ===');
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏
window.quickTest = function() {
  console.log('üöÄ === –ë–´–°–¢–†–´–ô –¢–ï–°–¢ ===');
  const hasSDKGlobal = typeof telegramAnalytics !== 'undefined';
  const hasSDKWindow = typeof window.telegramAnalyticsSDK !== 'undefined';
  console.log('SDK (–≥–ª–æ–±–∞–ª—å–Ω–æ):', hasSDKGlobal);
  console.log('SDK (window):', hasSDKWindow);
  console.log('WebApp:', !!(window.Telegram && window.Telegram.WebApp));
  console.log('User ID:', window.Telegram?.WebApp?.initDataUnsafe?.user?.id || '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ');
  
  if (window.telegramAnalyticsSDK) {
    console.log('‚úÖ SDK –º–µ—Ç–æ–¥—ã:', Object.keys(window.telegramAnalyticsSDK));
  } else if (!hasSDKGlobal && !hasSDKWindow) {
    console.log('‚ÑπÔ∏è SDK —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤');
    console.log('üí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network –≤–∫–ª–∞–¥–∫—É –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ tganalytics.xyz');
  }
  
  if (window.Telegram?.WebApp) {
    console.log('‚úÖ WebApp –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞:', window.Telegram.WebApp.platform);
    console.log('‚úÖ WebApp –≤–µ—Ä—Å–∏—è:', window.Telegram.WebApp.version);
  }
  
  console.log('üöÄ === –ö–û–ù–ï–¶ –¢–ï–°–¢–ê ===');
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ Telegram WebApp
window.waitForTelegram = function() {
  console.log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ Telegram WebApp...');
  let attempts = 0;
  const maxAttempts = 20;
  
  const checkInterval = setInterval(() => {
    attempts++;
    if (window.Telegram && window.Telegram.WebApp) {
      console.log('‚úÖ Telegram WebApp –∑–∞–≥—Ä—É–∂–µ–Ω –ø–æ—Å–ª–µ', attempts, '–ø–æ–ø—ã—Ç–æ–∫');
      clearInterval(checkInterval);
      checkTelegramAnalytics();
    } else if (attempts >= maxAttempts) {
      console.log('‚ùå Telegram WebApp –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –ø–æ—Å–ª–µ', maxAttempts, '–ø–æ–ø—ã—Ç–æ–∫');
      clearInterval(checkInterval);
    } else {
      console.log('‚è≥ –ü–æ–ø—ã—Ç–∫–∞', attempts, '–∏–∑', maxAttempts);
    }
  }, 500);
};

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
setTimeout(() => {
  console.log('üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Telegram Analytics...');
  if (window.Telegram && window.Telegram.WebApp) {
    checkAnalyticsRealStatus();
  } else {
    console.log('‚è≥ Telegram WebApp –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø—É—Å–∫–∞—é –æ–∂–∏–¥–∞–Ω–∏–µ...');
    window.waitForTelegram();
  }
}, 3000);

console.log('üîß –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:');
console.log('  - checkAnalyticsRealStatus() - –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø (—Ä–µ–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å)');
console.log('  - quickTest() - –±—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç');
console.log('  - checkTelegramAnalytics() - –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞');
console.log('  - testTelegramWeb() - —Ç–µ—Å—Ç –¥–ª—è Telegram Web');
console.log('  - analyticsStatus() - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞');
console.log('  - waitForTelegram() - –æ–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ WebApp');
console.log('');
console.log('‚úÖ –°–¢–ê–¢–£–°: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!');
console.log('üì° –ì–ª–∞–≤–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç—ã - –∑–∞–ø—Ä–æ—Å—ã –∫ tganalytics.xyz –≤ Network –≤–∫–ª–∞–¥–∫–µ.'); 